<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>XML Parser Test</title>
</head>
<body>
    <h1>XML Parser Test</h1>
    <pre id="output"></pre>

    <script type="module">
        import { parseXMLToProject } from './general-files/xml-io.js';

        async function testParser() {
            const output = document.getElementById('output');

            try {
                // Fetch the XML file
                const response = await fetch('./test-import-2.xml');
                const xmlText = await response.text();

                output.textContent = 'Parsing XML...\n\n';

                // Parse it
                const projectData = parseXMLToProject(xmlText);

                output.textContent += '✓ XML parsed successfully!\n\n';
                output.textContent += 'Project Data Summary:\n';
                output.textContent += '====================\n';
                output.textContent += `Nodes: ${projectData.nodes.length}\n`;
                output.textContent += `Walls: ${projectData.walls.length}\n`;
                output.textContent += `Doors: ${projectData.doors.length}\n`;
                output.textContent += `Columns: ${projectData.columns.length}\n`;

                // Count windows and vents on walls
                let totalWindows = 0;
                let totalVents = 0;
                projectData.walls.forEach(wall => {
                    totalWindows += wall.windows.length;
                    totalVents += wall.vents.length;
                });
                output.textContent += `Windows (on walls): ${totalWindows}\n`;
                output.textContent += `Vents (on walls): ${totalVents}\n`;

                output.textContent += '\n--- Node Details ---\n';
                projectData.nodes.forEach((node, i) => {
                    output.textContent += `  [${i}] (${node.x.toFixed(2)}, ${node.y.toFixed(2)})\n`;
                });

                output.textContent += '\n--- Wall Details ---\n';
                projectData.walls.forEach((wall, i) => {
                    output.textContent += `  [${i}] Node ${wall.p1Index} → Node ${wall.p2Index}\n`;
                });

                output.textContent += '\n✓ Test completed successfully!';

            } catch (error) {
                output.textContent += '❌ Error: ' + error.message + '\n';
                output.textContent += error.stack;
            }
        }

        testParser();
    </script>
</body>
</html>
