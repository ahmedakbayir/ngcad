<!doctype html>
<html lang="tr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profesyonel 2D/3D Mimari Editör</title>
  <link rel="stylesheet" href="./general-files/style.css" />
  <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
</head>

<body>
  <!-- Proje Modları - En sol üst köşe -->
  <div id="drawing-mode-selector">
    <button class="mode-btn" id="mode-mimari" title="Mimari Mod">MİMARİ</button>
    <button class="mode-btn" id="mode-tesisat" title="Tesisat Mod">TESİSAT</button>
    <button class="mode-btn active" id="mode-karma" title="Karma Mod">KARMA</button>
  </div>

  <div id="ui" class="display-big-icon">

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- GENEL İŞLEMLER -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="button-group draggable-group" id="group-general">
          <div class="group-label drag-handle">GENEL</div>
          <button id="bSel" class="btn" title="Seç">
            <svg viewBox="0 0 24 24">
              <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z" stroke-width="1.5"></path>
            </svg>
            Seç
          </button>
          <button id="bDelete" class="btn" title="Sil" tabindex="-1">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
              stroke-linejoin="round">
              <polyline points="3 6 5 6 21 6"></polyline>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
              <line x1="10" y1="11" x2="10" y2="17"></line>
              <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
            Sil
          </button>
          <button id="bSave" class="btn" title="Kaydet">
            <svg viewBox="0 0 24 24">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
              <polyline points="17 21 17 13 7 13 7 21"></polyline>
              <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
            Kaydet
          </button>
          <button id="bOpen" class="btn" title="Aç">
            <svg viewBox="0 0 24 24">
              <path d="M3 7v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-7l-2-2H5a2 2 0 0 0-2 2z"></path>
            </svg>
            Aç
          </button>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- MİMARİ ELEMANLAR -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="button-group draggable-group" id="group-architecture">
          <div class="group-label drag-handle">MİMARİ</div>
          <button id="bWall" class="btn" title="Duvar">
            <svg viewBox="0 0 24 24">
              <path d="M5 6H19v5h3v5H19v5H5V16H2V11H5V6Zm0 5H19M5 16H19M12 6v5M8.5 11v5m7-5v5M12 16v5"
                stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="none">
              </path>
            </svg>
            Duvar
          </button>
          <button id="bRoom" class="btn" title="Oda">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#e6e6e6" stroke-width="2">
              <path d="M15 21
            h5 
            a1 1 0 0 0 1-1
            V5
            a1 1 0 0 0-1-1
            H5
            a1 1  0 0 0-1 1 
            v15
            a1 1  0 0 0 1 1 
            h5" />
              <path d="M10 21 v-5a5 5 0 0 1 5 5" stroke-width="0.5" />
            </svg>
            Oda
          </button>
          <button id="bDoor" class="btn" title="Kapı">
            <svg viewBox="0 0 24 24">
              <path d="M18 24V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v18"></path>
              <line x1="10" y1="12" x2="10" y2="12" stroke-width="3" stroke-linecap="round"></line>

            </svg>
            Kapı
          </button>
          <button id="bWindow" class="btn" title="Pencere">
            <svg viewBox="0 0 24 24">
              <rect x="3" y="3" width="18" height="18" rx="1" ry="1" stroke-width="1.5" fill="none"
                stroke="currentColor"></rect>
              <line x1="12" y1="3" x2="12" y2="21" stroke-width="1.5" stroke="currentColor"></line>
              <line x1="3" y1="12" x2="21" y2="12" stroke-width="1.5" stroke="currentColor"></line>
              <line x1="2" y1="21.5" x2="22" y2="21.5" stroke-width="3" stroke="currentColor" stroke-linecap="round">
              </line>
            </svg>
            Pencere
          </button>
          <button id="bColumn" class="btn" title="Kolon">
            <svg viewBox="0 0 24 24">
              <rect x="8" y="4" width="8" height="1" stroke-width="1.5" fill="currentColor" />
              <line x1="12" y1="6" x2="12" y2="17" stroke-width="6" />
              <!-- <line x1="14" y1="6" x2="14" y2="18" stroke-width="3" /> -->
              <rect x="8" y="18" width="8" height="1" stroke-width="1.5" fill="currentColor" />
            </svg>
            Kolon
          </button>
          <button id="bBeam" class="btn" title="Kiriş">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g stroke-width="2" stroke-linecap="round">

                <line x1="3" y1="10" x2="3" y2="14" />
                <line x1="21" y1="10" x2="21" y2="14" />

                <line x1="3" y1="10" x2="7" y2="10" />
                <line x1="10" y1="10" x2="14" y2="10" />
                <line x1="17" y1="10" x2="21" y2="10" />


                <line x1="3" y1="14" x2="7" y2="14" />
                <line x1="10" y1="14" x2="14" y2="14" />
                <line x1="17" y1="14" x2="21" y2="14" />
              </g>
            </svg>
            Kiriş
          </button>
          <button id="bStairs" class="btn" title="Merdiven">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
              <line x1="6" y1="22" x2="6" y2="5" stroke-width="1.5" />
              <line x1="18" y1="22" x2="18" y2="5" stroke-width="1.5" />
              <line x1="6" y1="19" x2="18" y2="19" stroke-width="1.5" />
              <line x1="6" y1="14" x2="18" y2="14" stroke-width="1.5" />
              <line x1="6" y1="9" x2="18" y2="9" stroke-width="1.5" />
            </svg>
            Merdiven
          </button>
          <button id="bSymmetry" class="btn" title="Simetri">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
              stroke-linejoin="round">
              <path d="M12 3v18" />
              <path d="M8 7l-5 5 5 5" />
              <path d="M16 7l5 5-5 5" />
              <path d="M3 12h5" />
              <path d="M16 12h5" />
            </svg>
            Simetri
          </button>
          <button id="bAssignNames" class="btn" title="Mahal Tanımla">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
              stroke-linejoin="round">
              <path d="M5 9h14v10H5z" />
              <path d="M9 9V7c0-1.1.9-2 2-2h2c1.1 0 2 .9 2 2v2" />
              <path d="M19 13h2c1.1 0 2 .9 2 2v0c0 1.1-.9 2-2 2h-2" />
            </svg>
            Mahal Tanımla
          </button>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- TESİSAT BLOKLARI -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="button-group draggable-group" id="group-plumbing">
          <div class="group-label drag-handle">TESİSAT</div>
          <button id="bServisKutusu" class="btn" title="Servis Kutusu">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
              <rect x="3" y="1" width="16" height="22" rx="2" stroke-width="2" />
              <path d="M 20 20 h3v-4" stroke-width="2" />
              <text x="11" y="14" text-anchor="middle" font-size="8" font-weight="bold" stroke="none"
                fill="currentColor">SK</text>
            </svg>
            Servis Kutusu
          </button>
          <button id="bBoru" class="btn" title="Boru (T)">
            <svg height="24px" width="24px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
              xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 451.39 451.39" xml:space="preserve">
              <g transform="translate(33.85, 33.85) scale(0.85)">
                <g transform="rotate(180 225.695 225.695)">
                  <g transform="translate(0, 451.39) scale(1, -1)">
                    <g id="XMLID_28_">
                      <g>
                        <path style="fill:#FFFFFF;"
                          d="M437.029,439.43c0,0.79-0.31,1.54-0.87,2.1c-1.12,1.11-3.08,1.12-4.2,0l-11.91-11.92l4.2-4.19 l11.91,11.91C436.719,437.89,437.029,438.64,437.029,439.43z" />
                        <path
                          d="M18.269 68.58l9.13 9.13 44.94-44.94-9.13-9.13c-2.51-2.51-5.86-3.9-9.41-3.9-3.56 0-6.9 1.39-9.41 3.9l-26.12 26.12c-2.51 2.51-3.9 5.85-3.9 9.41C14.369 62.72 15.759 66.06 18.269 68.58zM280.849 353.05c11.07 11.07 23.02 21.04 35.74 29.88l60.97-60.97c-8.85-12.72-18.82-24.66-29.89-35.73L105.479 44.04l-66.82 66.82L280.849 353.05zM324.209 388.04c11.5 7.4 23.59 13.92 36.23 19.49l47.86 21.11 14.96-14.97-21.1-47.85c-5.57-12.64-12.09-24.74-19.5-36.23L324.209 388.04zM431.959 441.53c1.12 1.12 3.08 1.11 4.2 0 .56-.56.87-1.31.87-2.1 0-.79-.31-1.54-.87-2.1l-11.91-11.91-4.2 4.19L431.959 441.53zM442.519 430.97c4.67 4.66 4.67 12.25 0 16.92-2.33 2.33-5.4 3.5-8.46 3.5s-6.13-1.17-8.46-3.5l-11.91-11.91-3.38 3.38-53.5-23.59c-30.81-13.59-58.51-32.55-82.32-56.36l-255.81-255.8c-2.29-2.3-3.55-5.35-3.55-8.6 0-3.24 1.26-6.29 3.55-8.59l2.36-2.35-9.13-9.13c-4.22-4.21-6.54-9.81-6.54-15.77s2.32-11.56 6.54-15.78l26.12-26.11c4.21-4.22 9.81-6.54 15.77-6.54s11.56 2.32 15.77 6.54l9.13 9.12 2.35-2.34c4.73-4.74 12.44-4.74 17.18 0L132 58l222.58 222.57c23.81 23.82 42.77 51.51 56.36 82.32l23.58 53.5-3.37 3.37L442.519 430.97zM32.299 104.49l66.82-66.82-7.25-7.25c-.62-.61-1.42-.92-2.23-.92-.81 0-1.61.31-2.23.92l-62.36 62.37c-.6.59-.92 1.38-.92 2.22 0 .85.32 1.64.92 2.23L32.299 104.49z" />

                        <path style="fill:currentColor;"
                          d="M347.669,286.23c11.07,11.07,21.04,23.01,29.89,35.73l-60.97,60.97 c-12.72-8.84-24.67-18.81-35.74-29.88L38.659,110.86l66.82-66.82L347.669,286.23z" />

                      </g>
                    </g>
                  </g>
                </g>
              </g>
            </svg>
            Boru
          </button>
          <button id="bSayac" class="btn" title="Sayaç">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
              <rect x="4" y="6" width="16" height="16" rx="2" stroke-width="1.6" />
              <text x="12" y="17" text-anchor="middle" font-size="8" font-weight="bold" stroke="none"
                fill="currentColor">G4</text>
              <path d="M 9 5 L 9 2 M 9 2 L 6 2" stroke-width="2" stroke-linecap="round" />
              <!-- Sağ kol (sağa döner) -->
              <path d="M 15 5 L 15 2 M 15 2 L 18 2" stroke-width="2" stroke-linecap="round" />
            </svg>
            Sayaç
          </button>
          <button id="bVana" class="btn" title="Vana">
            <svg viewBox="0 0 24 24">
              <path d="M 12 12 l-5-4 v8 Z" />
              <path d="M 12 12 l5-4 v8 Z" />

            </svg>
            Vana
          </button>
          <button id="bKombi" class="btn" title="Kombi">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
              <circle cx="12" cy="12" r="11" stroke-width="1.5" />
              <circle cx="12" cy="12" r="8" stroke-width="1.5" />
              <text x="12" y="15" text-anchor="middle" font-size="10" font-weight="bold" stroke="none"
                fill="currentColor">G</text>
            </svg>
            Kombi
          </button>
          <button id="bOcak" class="btn" title="Ocak">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
              <rect x="4" y="4" width="16" height="16" rx="2" stroke-width="1.5" />
              <circle cx="9" cy="9" r="2" stroke-width="1" />
              <circle cx="15" cy="9" r="2" stroke-width="1" />
              <circle cx="9" cy="15" r="2" stroke-width="1" />
              <circle cx="15" cy="15" r="2" stroke-width="1" />
            </svg>
            Ocak
          </button>
          <button id="bBaca" class="btn" title="Baca">
            <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
              <!-- <line x1="1" y1="0" x2="1" y2="24" stroke-width="1.5" />
              <line x1="4" y1="0" x2="4" y2="24" stroke-width="1.5" /> -->

              <!-- <rect x="1" y="9" width="3" height="12" rx="1" stroke-width="1" /> -->
              <rect x="2" y="9" width="17" height="6" rx="1" stroke-width="1" />

              <rect x="19" y="6" width="4" height="12" rx="0.5" stroke-width="1" fill="none" />
              <line x1="19" y1="12" x2="23" y2="12" stroke-width="1" />
            </svg>
            Baca
          </button>

        </div>
        <input type="file" id="file-input" accept=".json, .pdf, .xml" style="display: none" />
  </div>

  <!-- İzometri ve 3D Göster butonları - Araç çubuğundan bağımsız -->
  <button id="bIso" class="btn btn-show-iso">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round">
      <!-- İzometrik kutu ikonu -->
      <path d="M12 2L4 7v10l8 5 8-5V7z"></path>
      <path d="M12 22v-10"></path>
      <path d="M4 7l8 5 8-5"></path>
      <path d="M12 2v10"></path>
    </svg>
    İzometri
  </button>
  <button id="b3d" class="btn btn-show-3d">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
      stroke-linejoin="round">
      <path
        d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z">
      </path>
      <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
      <line x1="12" y1="22.08" x2="12" y2="12"></line>
    </svg>
    3D Göster
  </button>

  <div class="main" id="main-container">
    <div id="p2d" class="panel">
      <button id="settings-btn" class="btn">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"></circle>
          <path
            d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42">
          </path>
        </svg>
        Ayarlar
      </button>

      <div id="settings-popup">
        <div class="settings-header">
          <span class="settings-title">Ayarlar</span>
          <div class="settings-header-controls">
            <label class="theme-toggle" title="Light/Dark Mode">
              <input type="checkbox" id="dark-mode-toggle" checked />
              <span class="theme-toggle-slider">
                <svg class="theme-icon sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round">
                  <circle cx="12" cy="12" r="5" />
                  <line x1="12" y1="1" x2="12" y2="3" />
                  <line x1="12" y1="21" x2="12" y2="23" />
                  <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                  <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                  <line x1="1" y1="12" x2="3" y2="12" />
                  <line x1="21" y1="12" x2="23" y2="12" />
                  <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                  <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                </svg>
                <svg class="theme-icon moon-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                </svg>
              </span>
            </label>
            <button id="close-settings-popup" class="close-settings-btn">✕</button>
          </div>
        </div>
        <div class="settings-body">
          <div class="tab-bar-vertical">
            <button class="tab-btn-vertical active" id="tab-btn-general">Genel</button>
            <button class="tab-btn-vertical" id="tab-btn-grid">Grid</button>
            <button class="tab-btn-vertical" id="tab-btn-snap">Snap</button>
            <button class="tab-btn-vertical" id="tab-btn-dimension">Ölçülendirme</button>
            <button class="tab-btn-vertical" id="tab-btn-stairs">Merdiven</button>
            <button class="tab-btn-vertical" id="tab-btn-plumbing">Tesisat</button>
          </div>
          <div class="tab-content-vertical">
            <div class="tab-pane active" id="tab-pane-general">
              <div class="setting-control">
                <label for="borderPicker">Duvar Rengi</label>
                <input type="color" id="borderPicker" />
              </div>
              <div class="setting-control">
                <label for="roomPicker">Mahal Rengi</label>
                <input type="color" id="roomPicker" />
              </div>
              <div class="setting-control">
                <label for="line-thickness">Duvar Çizgi Kalınlığı</label>
                <input type="number" id="line-thickness" min="1" max="10" step="0.5" />
              </div>
              <div class="setting-control">
                <label for="wall-thickness">Duvar Kalınlığı (cm)</label>
                <input type="number" id="wall-thickness" min="1" max="100" step="1" />
              </div>
              <div class="setting-control">
                <label for="drawing-angle">Çizim Açısı (°)</label>
                <input type="number" id="drawing-angle" min="0" max="180" step="1" />
              </div>
              <div class="setting-control">
                <label for="default-floor-height">Kat Yüksekliği (cm)</label>
                <input type="number" id="default-floor-height" min="100" max="500" step="10" />
              </div>
            </div>
            <div class="tab-pane" id="tab-pane-grid">
              <div class="setting-control">
                <label for="grid-visible">Gridi Göster</label>
                <input type="checkbox" id="grid-visible" />
              </div>
              <div class="setting-control">
                <label for="grid-color">Renk</label>
                <input type="color" id="grid-color" />
              </div>
              <div class="setting-control">
                <label for="grid-weight">Kalınlık (px)</label>
                <input type="number" id="grid-weight" min="0.1" max="5" step="0.1" />
              </div>
              <div class="setting-control">
                <label for="grid-space">Aralık (cm)</label>
                <input type="number" id="grid-space" min="1" max="50" step="1" />
              </div>
            </div>
            <div class="tab-pane" id="tab-pane-snap">
              <div class="setting-control">
                <label for="snap-endpoint">Uç Noktalar</label>
                <input type="checkbox" id="snap-endpoint" />
              </div>
              <div class="setting-control">
                <label for="snap-midpoint">Orta Noktalar</label>
                <input type="checkbox" id="snap-midpoint" />
              </div>
              <div class="setting-control">
                <label for="snap-endpoint-ext">Uç Nokta Uzantıları</label>
                <input type="checkbox" id="snap-endpoint-ext" />
              </div>
              <div class="setting-control">
                <label for="snap-midpoint-ext">Orta Nokta Uzantıları</label>
                <input type="checkbox" id="snap-midpoint-ext" />
              </div>
              <div class="setting-control">
                <label for="snap-nearest-only">Sadece Yakın Duvarlar</label>
                <input type="checkbox" id="snap-nearest-only" />
              </div>
            </div>
            <div class="tab-pane" id="tab-pane-dimension">
              <div class="setting-control">
                <label for="dimension-font-size">Yazı Boyutu</label>
                <input type="number" id="dimension-font-size" min="6" max="32" step="1" />
              </div>
              <div class="setting-control">
                <label for="dimension-color">Renk</label>
                <input type="color" id="dimension-color" />
              </div>
              <div class="setting-control">
                <label for="dimension-default-view">Varsayılan Görünüm</label>
                <select id="dimension-default-view">
                  <option value="0">Kapalı</option>
                  <option value="1">Özet</option>
                  <option value="2">Detaylı</option>
                </select>
              </div>
              <div class="setting-control">
                <label for="dimension-show-area">m² Bilgisini Göster</label>
                <select id="dimension-show-area">
                  <option value="0">Kapalı</option>
                  <option value="1">Açık</option>
                  <option value="2">Sadece Özet Görünümde</option>
                  <option value="3">Sadece Detaylı Görünümde</option>
                </select>
              </div>
              <div class="setting-control">
                <label for="dimension-show-outer">Dış Ölçüyü Göster</label>
                <select id="dimension-show-outer">
                  <option value="0">Kapalı</option>
                  <option value="1">Açık</option>
                  <option value="2">Sadece Özet Görünümde</option>
                  <option value="3">Sadece Detaylı Görünümde</option>
                </select>
              </div>
            </div>
            <div class="tab-pane" id="tab-pane-stairs">
              <div class="setting-control">
                <label for="stairs-show-railing">Korkuluk Göster</label>
                <input type="checkbox" id="stairs-show-railing" />
              </div>
              <div class="setting-control">
                <label for="stairs-step-depth">Basamak Derinliği</label>
                <select id="stairs-step-depth">
                  <option value="20-30">20-30 cm</option>
                  <option value="25-35">25-35 cm</option>
                  <option value="30-40">30-40 cm</option>
                  <option value="35-45">35-45 cm</option>
                  <option value="40-50">40-50 cm</option>
                  <option value="45-55">45-55 cm</option>
                  <option value="50-60">50-60 cm</option>
                </select>
              </div>
            </div>
            <div class="tab-pane" id="tab-pane-plumbing">
              <div class="setting-control">
                <label>Düşey Mod Hızlı Değerler (cm)</label>
              </div>
              <div class="setting-control">
                <label for="vertical-quick-1">Değer 1</label>
                <input type="number" id="vertical-quick-1" min="1" max="1000" step="1" value="5" />
              </div>
              <div class="setting-control">
                <label for="vertical-quick-2">Değer 2</label>
                <input type="number" id="vertical-quick-2" min="1" max="1000" step="1" value="10" />
              </div>
              <div class="setting-control">
                <label for="vertical-quick-3">Değer 3</label>
                <input type="number" id="vertical-quick-3" min="1" max="1000" step="1" value="30" />
              </div>
              <div class="setting-control">
                <label for="vertical-quick-4">Değer 4</label>
                <input type="number" id="vertical-quick-4" min="1" max="1000" step="1" value="100" />
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="room-name-popup">
        <input type="text" id="room-name-input" placeholder="Arama..." />
        <select id="room-name-select" size="10"></select>
      </div>
      <div id="stair-popup">
        <h3>Merdiven Ayarları</h3>
        <div class="setting-control">
          <label for="stair-name">Merdiven Adı:</label>
          <input type="text" id="stair-name" value="A" />
        </div>
        <div class="setting-control">
          <label for="stair-bottom-elevation">Alt Kot (cm):</label>
          <input type="number" id="stair-bottom-elevation" value="0" />
        </div>
        <div class="setting-control">
          <label for="stair-top-elevation">Üst Kot (cm):</label>
          <input type="number" id="stair-top-elevation" value="270" />
        </div>
        <div class="setting-control">
          <label for="stair-width-edit">Merdiven Genişliği (cm):</label>
          <input type="number" id="stair-width-edit" value="120" />
        </div>
        <div class="setting-control">
          <label for="stair-connected-stair">Bağlı Olduğu Merdiven:</label>
          <select id="stair-connected-stair">
            <option value="">YOK</option>
          </select>
        </div>
        <div class="setting-control">
          <label for="stair-is-landing">Orta Düzlem:</label>
          <input type="checkbox" id="stair-is-landing" />
        </div>
        <div class="setting-control">
          <label for="stair-show-railing">Korkuluk Göster:</label>
          <input type="checkbox" id="stair-show-railing" checked />
        </div>
        <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px;">
          <button id="cancel-stair-popup" class="btn">İptal</button>
          <button id="confirm-stair-popup" class="btn">Tamam</button>
        </div>
      </div>
      <div id="panel-display-menu">
        <div class="context-menu-item-with-submenu">
          <button class="context-menu-btn submenu-trigger">
            Görüntüleme Modu ▶
          </button>
          <div class="context-submenu">
            <button id="display-btn-small-icon" class="context-menu-btn display-mode-option"
              data-mode="small-icon">Küçük İkon</button>
            <button id="display-btn-small-icon-text" class="context-menu-btn display-mode-option"
              data-mode="small-icon-text">Küçük İkon + Metin</button>
            <button id="display-btn-big-icon" class="context-menu-btn display-mode-option" data-mode="big-icon">Büyük
              İkon</button>
            <button id="display-btn-big-icon-text" class="context-menu-btn display-mode-option"
              data-mode="big-icon-text">Büyük İkon + Metin</button>
          </div>
        </div>
      </div>
      <div id="guide-context-menu">
        <div class="context-menu-item-with-submenu">
          <button class="context-menu-btn submenu-trigger">
            Referans Ekle ▶
          </button>
          <div class="context-submenu">
            <button id="guide-btn-point" class="context-menu-btn">Nokta</button>
            <button id="guide-btn-horizontal" class="context-menu-btn">Yatay</button>
            <button id="guide-btn-vertical" class="context-menu-btn">Düşey</button>
            <button id="guide-btn-angular" class="context-menu-btn">Açısal</button>
            <button id="guide-btn-free" class="context-menu-btn">Serbest</button>
            <div class="context-menu-divider"></div>
            <button id="guide-btn-clear-all" class="context-menu-btn context-menu-danger">Referansları Temizle</button>
          </div>
        </div>
        <div class="context-menu-item-with-submenu">
          <button class="context-menu-btn submenu-trigger">
            Kat İşlemleri ▶
          </button>
          <div class="context-submenu">
            <button id="floor-btn-copy" class="context-menu-btn">Mimari Planı Kopyala <span
                style="opacity: 0.6; font-size: 0.9em;">(CTRL + C)</span></button>
            <button id="floor-btn-paste" class="context-menu-btn">Mimari Planı Yapıştır <span
                style="opacity: 0.6; font-size: 0.9em;">(CTRL + V)</span></button>
            <button id="floor-btn-paste-all" class="context-menu-btn">Bu Katın Mimari Planını Diğer Katlara
              Yapıştır</button>
            <div class="context-menu-divider"></div>
            <button id="floor-btn-clear" class="context-menu-btn context-menu-danger">Katın Mimari Planını Sil</button>
          </div>
        </div>
      </div>
      <canvas id="c2d"></canvas>

      <!-- Düşey Yükseklik Paneli -->
      <div id="vertical-height-panel" class="vertical-panel" style="display: none;">
        <div class="vertical-panel-header">Üst Kata Çık</div>
        <div class="vertical-panel-main">
          <div class="vertical-counter">
            <input type="number" class="vertical-input" id="vertical-height-input" value="0" readonly />
            <div class="vertical-arrows">
              <button class="vertical-arrow-btn" id="vertical-arrow-up" title="Artır">▲</button>
              <button class="vertical-arrow-btn" id="vertical-arrow-down" title="Azalt">▼</button>
            </div>
          </div>
          <div class="vertical-quick-values">
            <div class="vertical-quick-row">
              <button class="vertical-quick-minus" data-value="-5">−</button>
              <span class="vertical-quick-label">5</span>
              <button class="vertical-quick-plus" data-value="5">+</button>
            </div>
            <div class="vertical-quick-row">
              <button class="vertical-quick-minus" data-value="-10">−</button>
              <span class="vertical-quick-label">10</span>
              <button class="vertical-quick-plus" data-value="10">+</button>
            </div>
            <div class="vertical-quick-row">
              <button class="vertical-quick-minus" data-value="-30">−</button>
              <span class="vertical-quick-label">30</span>
              <button class="vertical-quick-plus" data-value="30">+</button>
            </div>
            <div class="vertical-quick-row">
              <button class="vertical-quick-minus" data-value="-100">−</button>
              <span class="vertical-quick-label">100</span>
              <button class="vertical-quick-plus" data-value="100">+</button>
            </div>
          </div>
        </div>
        <div class="vertical-panel-footer">Alt Kata İn</div>
      </div>

      <input type="text" id="length-input" />
    </div>
    <div id="splitter"></div>
    <div id="p3d" class="panel">
      <canvas id="c3d"></canvas>
      <!-- 3D Overlay: Ekran Bölme Oranı Butonları (Sağ Üst) -->
      <div id="split-ratio-buttons" style="display: none;">
        <!-- Katı Göster / Binayı Göster toggle butonu (dikdörtgen, sadece metin) -->
        <button id="bFloorView" class="floor-view-btn" title="Katı Göster / Binayı Göster" data-view-mode="floor">
          KAT
        </button>
        <!-- Ayırıcı -->
        <div style="width: 1px; height: 24px; background: #5f6368; margin: 0 6px;"></div>
        <!-- Ekran bölme butonları -->
        <button id="split-100" class="split-btn" data-ratio="100" title="Tam Ekran 3D">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="20" height="20" fill="#87CEEB" stroke="#666" stroke-width="1" />
          </svg>
        </button>
        <button id="split-75" class="split-btn" data-ratio="75" title="75% 3D">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="5" height="20" fill="#999" stroke="#666" stroke-width="1" />
            <rect x="7" y="2" width="15" height="20" fill="#87CEEB" stroke="#666" stroke-width="1" />
          </svg>
        </button>
        <button id="split-50" class="split-btn" data-ratio="50" title="50% 3D / 50% 2D">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="10" height="20" fill="#999" stroke="#666" stroke-width="1" />
            <rect x="12" y="2" width="10" height="20" fill="#87CEEB" stroke="#666" stroke-width="1" />
          </svg>
        </button>
        <button id="split-25" class="split-btn" data-ratio="25" title="25% 3D">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="15" height="20" fill="#999" stroke="#666" stroke-width="1" />
            <rect x="17" y="2" width="5" height="20" fill="#87CEEB" stroke="#666" stroke-width="1" />
          </svg>
        </button>
        <button id="split-0" class="split-btn" data-ratio="0" title="3D Kapalı">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="20" height="20" fill="#999" stroke="#666" stroke-width="1" />
            <!-- × işareti (Close/Kapalı) -->
            <line x1="8" y1="8" x2="16" y2="16" stroke="#fff" stroke-width="2" stroke-linecap="round" />
            <line x1="16" y1="8" x2="8" y2="16" stroke="#fff" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <!-- 3D Opacity Kontrolleri -->
      <div id="opacity-controls-container" style="display: none;">
        <button id="opacity-toggle-btn" class="opacity-toggle-btn" title="Saydamlık Ayarları">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10" />
            <path d="M12 2 A10 10 0 0 1 12 22 Z" fill="currentColor" opacity="0.3" />
          </svg>
        </button>
        <div id="opacity-panel" class="opacity-panel">
          <div class="opacity-item opacity-item-all">
            <label for="opacity-all">HEPSİ</label>
            <input type="range" id="opacity-all" min="5" max="100" value="100" class="opacity-slider">
            <span class="opacity-value">100</span>
          </div>
          <div class="opacity-divider"></div>
          <div class="opacity-item">
            <label for="opacity-wall">Duvar</label>
            <input type="range" id="opacity-wall" min="5" max="100" value="100" class="opacity-slider">
            <span class="opacity-value">100</span>
          </div>
          <div class="opacity-item">
            <label for="opacity-floor">Zemin</label>
            <input type="range" id="opacity-floor" min="5" max="100" value="100" class="opacity-slider">
            <span class="opacity-value">100</span>
          </div>
          <div class="opacity-item">
            <label for="opacity-door">Kapı</label>
            <input type="range" id="opacity-door" min="5" max="100" value="100" class="opacity-slider">
            <span class="opacity-value">100</span>
          </div>
          <div class="opacity-item">
            <label for="opacity-window">Pencere</label>
            <input type="range" id="opacity-window" min="5" max="100" value="100" class="opacity-slider">
            <span class="opacity-value">100</span>
          </div>
          <div class="opacity-item">
            <label for="opacity-column">Kolon</label>
            <input type="range" id="opacity-column" min="5" max="100" value="100" class="opacity-slider">
            <span class="opacity-value">100</span>
          </div>
          <div class="opacity-item">
            <label for="opacity-beam">Kiriş</label>
            <input type="range" id="opacity-beam" min="5" max="100" value="100" class="opacity-slider">
            <span class="opacity-value">100</span>
          </div>
          <div class="opacity-item">
            <label for="opacity-stair">Merdiven</label>
            <input type="range" id="opacity-stair" min="5" max="100" value="100" class="opacity-slider">
            <span class="opacity-value">100</span>
          </div>
        </div>
      </div>
      <!-- FPS Kamera ve Koordinatlar (Sağ Alt) -->
      <div id="fps-camera-controls" style="display: none;">
        <span id="camera-coords" style="display: none;">x: 0, y: 0, z: 0</span>
        <button id="bFirstPerson" class="fps-btn" title="FPS Kamera">FPS Kamera</button>
      </div>
      <!-- Mod Göstergesi (Her Zaman Görünür) -->
    </div>
    <div id="pIso" class="panel">
      <canvas id="cIso"></canvas>
      <!-- İzometri Overlay: Ekran Bölme Oranı Butonları (Sağ Üst) -->
      <div id="iso-ratio-buttons" style="display: none;">
        <button id="iso-reset" class="split-btn" title="Orijinal Boyut" style="margin-right: 8px;">
          <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
            <!-- Reset/Refresh icon -->
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
            <path d="M21 3v5h-5"></path>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
            <path d="M3 21v-5h5"></path>
          </svg>
        </button>
        <button id="iso-100" class="split-btn" data-ratio="100" title="Tam Ekran İzometri">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="20" height="20" fill="#FFB74D" stroke="#666" stroke-width="1" />
          </svg>
        </button>
        <button id="iso-75" class="split-btn" data-ratio="75" title="75% İzometri">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="5" height="20" fill="#999" stroke="#666" stroke-width="1" />
            <rect x="7" y="2" width="15" height="20" fill="#FFB74D" stroke="#666" stroke-width="1" />
          </svg>
        </button>
        <button id="iso-50" class="split-btn" data-ratio="50" title="50% İzometri / 50% 2D">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="10" height="20" fill="#999" stroke="#666" stroke-width="1" />
            <rect x="12" y="2" width="10" height="20" fill="#FFB74D" stroke="#666" stroke-width="1" />
          </svg>
        </button>
        <button id="iso-25" class="split-btn" data-ratio="25" title="25% İzometri">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="15" height="20" fill="#999" stroke="#666" stroke-width="1" />
            <rect x="17" y="2" width="5" height="20" fill="#FFB74D" stroke="#666" stroke-width="1" />
          </svg>
        </button>
        <button id="iso-0" class="split-btn" data-ratio="0" title="İzometri Kapalı">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <rect x="2" y="2" width="20" height="20" fill="#999" stroke="#666" stroke-width="1" />
            <!-- × işareti (Close/Kapalı) -->
            <line x1="8" y1="8" x2="16" y2="16" stroke="#fff" stroke-width="2" stroke-linecap="round" />
            <line x1="16" y1="8" x2="8" y2="16" stroke="#fff" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    // PDF.js worker'ını ayarla
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
  </script>

  <script src="https://unpkg.com/@tweenjs/tween.js@23.1.1/dist/tween.umd.js"></script>
  <script type="importmap">
  {
    "imports": {
      "three": "https://unpkg.com/three@0.163.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.163.0/examples/jsm/"
    }
  }
  </script>
<script type="module" src="./app.js"></script>

</body>

</html>