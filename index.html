<!doctype html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Profesyonel 2D/3D Mimari Editör</title>
<link rel="stylesheet" href="./general-files/style.css" />
<script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
</head>
<body>
<div class="main" id="main-container">
<div id="p2d" class="panel">
<div id="ui">
<button id="bSel" class="btn">
 <svg viewBox="0 0 24 24"><path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z" stroke-width="1.5"></path></svg>
 Seç
 </button>
 <button id="bWall" class="btn">
  <svg viewBox="0 0 24 24"><line x1="3" y1="12" x2="21" y2="12" stroke-width="4" stroke-linecap="round"></line></svg>
  Duvar
 </button>
 <button id="bRoom" class="btn">
  <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect></svg>
  Oda
 </button>
 <button id="bDoor" class="btn">
  <svg viewBox="0 0 24 24"><path d="M18 20V6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14"></path><line x1="10" y1="12" x2="10" y2="12" stroke-width="3" stroke-linecap="round"></line></svg>
  Kapı
 </button>
 <button id="bWindow" class="btn">
  <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="1" ry="1" stroke-width="1.5"></rect><line x1="12" y1="3" x2="12" y2="21" stroke-width="1.5"></line><line x1="3" y1="12" x2="21" y2="12" stroke-width="1.5"></line></svg>
  Pencere
 </button>
 <button id="bColumn" class="btn">
  <svg viewBox="0 0 24 24">
    <rect x="8" y="4" width="8" height="2" stroke-width="1.5" fill="currentColor"/>
    <line x1="10" y1="6" x2="10" y2="18" stroke-width="1.5"/>
    <line x1="14" y1="6" x2="14" y2="18" stroke-width="1.5"/>
    <rect x="8" y="18" width="8" height="2" stroke-width="1.5" fill="currentColor"/>
  </svg>
  Kolon
</button>
<button id="bBeam" class="btn">
  <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
    <rect x="3" y="10" width="18" height="4" stroke-width="1.5"/>
  </svg>
  Kiriş
</button>
<button id="bStairs" class="btn">
  <svg viewBox="0 0 24 24" stroke="currentColor" fill="none">
    <line x1="6" y1="19" x2="6" y2="5" stroke-width="1.5"/>
    <line x1="18" y1="19" x2="18" y2="5" stroke-width="1.5"/>
    <line x1="6" y1="19" x2="18" y2="19" stroke-width="1.5"/>
    <line x1="6" y1="14" x2="18" y2="14" stroke-width="1.5"/>
    <line x1="6" y1="9" x2="18" y2="9" stroke-width="1.5"/>
  </svg>
  Merdiven
</button>
<button id="bSymmetry" class="btn"> <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 3v18"/> <path d="M8 7l-5 5 5 5"/> <path d="M16 7l5 5-5 5"/> <path d="M3 12h5"/> <path d="M16 12h5"/> </svg>
    Simetri
 </button>

<button id="bSave" class="btn">
 <svg viewBox="0 0 24 24"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>
 Kaydet
 </button>
 <button id="bOpen" class="btn">
 <svg viewBox="0 0 24 24"><path d="M3 7v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-7l-2-2H5a2 2 0 0 0-2 2z"></path></svg>
 Aç
 </button>
 <button id="b3d" class="btn">
 <svg viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>
 3D Göster
 </button>
 <button id="bAssignNames" class="btn">Mahal Tanımla</button>
<input type="file" id="file-input" accept=".json, .pdf, .xml" style="display: none"/>
</div>

<button id="settings-btn" class="btn">
 <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"></circle><path d="M12 1v6m0 6v6m0-6h6m-6 0H6m12.364-7.364l-4.243 4.243m0 6.243l4.243 4.243M7.879 7.879l4.243 4.243m-4.243 4.243l4.243-4.243" stroke-width="1.5"></path></svg>
 Ayarlar
</button>

<div id="settings-popup">
 <div class="settings-header">
  <span class="settings-title">Ayarlar</span>
  <button id="close-settings-popup" style="background: transparent; border: none; color: #e7e6d0; cursor: pointer; font-size: 18px; padding: 0; width: 24px; height: 24px;">✕</button>
 </div>
 <div class="settings-body">
  <div class="tab-bar-vertical">
   <button class="tab-btn-vertical active" id="tab-btn-general">Genel</button>
   <button class="tab-btn-vertical" id="tab-btn-grid">Grid</button>
   <button class="tab-btn-vertical" id="tab-btn-snap">Snap</button>
   <button class="tab-btn-vertical" id="tab-btn-dimension">Ölçülendirme</button>
   <button class="tab-btn-vertical" id="tab-btn-stairs">Merdiven</button>
  </div>
  <div class="tab-content-vertical">
   <div class="tab-pane active" id="tab-pane-general">
    <div class="setting-control">
     <label for="borderPicker">Duvar Rengi</label>
     <input type="color" id="borderPicker" />
    </div>
    <div class="setting-control">
     <label for="roomPicker">Mahal Rengi</label>
     <input type="color" id="roomPicker" />
    </div>
    <div class="setting-control">
     <label for="line-thickness">Duvar Çizgi Kalınlığı</label>
     <input type="number" id="line-thickness" min="1" max="10" step="0.5" />
    </div>
    <div class="setting-control">
     <label for="wall-thickness">Duvar Kalınlığı (cm)</label>
     <input type="number" id="wall-thickness" min="1" max="100" step="1" />
    </div>
    <div class="setting-control">
     <label for="drawing-angle">Çizim Açısı (°)</label>
     <input type="number" id="drawing-angle" min="0" max="180" step="1" />
    </div>
    <div class="setting-control">
     <label for="default-floor-height">Kat Yüksekliği (cm)</label>
     <input type="number" id="default-floor-height" min="100" max="500" step="10" />
    </div>
   </div>
   <div class="tab-pane" id="tab-pane-grid">
    <div class="setting-control">
     <label for="grid-visible">Gridi Göster</label>
     <input type="checkbox" id="grid-visible" />
    </div>
    <div class="setting-control">
     <label for="grid-color">Renk</label>
     <input type="color" id="grid-color" />
    </div>
    <div class="setting-control">
     <label for="grid-weight">Kalınlık (px)</label>
     <input type="number" id="grid-weight" min="0.1" max="5" step="0.1" />
    </div>
    <div class="setting-control">
     <label for="grid-space">Aralık (cm)</label>
     <input type="number" id="grid-space" min="1" max="50" step="1" />
    </div>
   </div>
   <div class="tab-pane" id="tab-pane-snap">
    <div class="setting-control">
     <label for="snap-endpoint">Uç Noktalar</label>
     <input type="checkbox" id="snap-endpoint" />
    </div>
    <div class="setting-control">
     <label for="snap-midpoint">Orta Noktalar</label>
     <input type="checkbox" id="snap-midpoint" />
    </div>
    <div class="setting-control">
     <label for="snap-endpoint-ext">Uç Nokta Uzantıları</label>
     <input type="checkbox" id="snap-endpoint-ext" />
    </div>
    <div class="setting-control">
     <label for="snap-midpoint-ext">Orta Nokta Uzantıları</label>
     <input type="checkbox" id="snap-midpoint-ext" />
    </div>
    <div class="setting-control">
     <label for="snap-nearest-only">Sadece Yakın Duvarlar</label>
     <input type="checkbox" id="snap-nearest-only" />
    </div>
   </div>
   <div class="tab-pane" id="tab-pane-dimension">
    <div class="setting-control">
     <label for="dimension-font-size">Yazı Boyutu</label>
     <input type="number" id="dimension-font-size" min="6" max="32" step="1" />
    </div>
    <div class="setting-control">
     <label for="dimension-color">Renk</label>
     <input type="color" id="dimension-color" />
    </div>
    <div class="setting-control">
     <label for="dimension-default-view">Varsayılan Görünüm</label>
     <select id="dimension-default-view">
      <option value="0">Kapalı</option>
      <option value="1">Özet</option>
      <option value="2">Detaylı</option>
     </select>
    </div>
    <div class="setting-control">
     <label for="dimension-show-area">m² Bilgisini Göster</label>
     <select id="dimension-show-area">
      <option value="0">Kapalı</option>
      <option value="1">Açık</option>
      <option value="2">Sadece Özet Görünümde</option>
      <option value="3">Sadece Detaylı Görünümde</option>
     </select>
    </div>
    <div class="setting-control">
     <label for="dimension-show-outer">Dış Ölçüyü Göster</label>
     <select id="dimension-show-outer">
      <option value="0">Kapalı</option>
      <option value="1">Açık</option>
      <option value="2">Sadece Özet Görünümde</option>
      <option value="3">Sadece Detaylı Görünümde</option>
     </select>
    </div>
   </div>
   <div class="tab-pane" id="tab-pane-stairs">
    <div class="setting-control">
     <label for="stairs-show-railing">Korkuluk Göster</label>
     <input type="checkbox" id="stairs-show-railing" />
    </div>
    <div class="setting-control">
     <label for="stairs-step-depth">Basamak Derinliği</label>
     <select id="stairs-step-depth">
      <option value="20-30">20-30 cm</option>
      <option value="25-35">25-35 cm</option>
      <option value="30-40">30-40 cm</option>
      <option value="35-45">35-45 cm</option>
      <option value="40-50">40-50 cm</option>
      <option value="45-55">45-55 cm</option>
      <option value="50-60">50-60 cm</option>
     </select>
    </div>
   </div>
  </div>
 </div>
</div>

<div id="room-name-popup">
 <input type="text" id="room-name-input" placeholder="Arama..."/>
 <select id="room-name-select" size="10"></select>
</div>
<div id="stair-popup">
    <h3>Merdiven Ayarları</h3>
    <div class="setting-control">
        <label for="stair-name">Merdiven Adı:</label>
        <input type="text" id="stair-name" value="A"/>
    </div>
    <div class="setting-control">
        <label for="stair-bottom-elevation">Alt Kot (cm):</label>
        <input type="number" id="stair-bottom-elevation" value="0"/>
    </div>
    <div class="setting-control">
        <label for="stair-top-elevation">Üst Kot (cm):</label>
        <input type="number" id="stair-top-elevation" value="270"/>
    </div>
    <div class="setting-control">
        <label for="stair-width-edit">Merdiven Genişliği (cm):</label>
        <input type="number" id="stair-width-edit" value="120"/>
    </div>
    <div class="setting-control">
        <label for="stair-connected-stair">Bağlı Olduğu Merdiven:</label>
        <select id="stair-connected-stair">
            <option value="">YOK</option>
            </select>
    </div>
    <div class="setting-control">
        <label for="stair-is-landing">Orta Düzlem:</label>
        <input type="checkbox" id="stair-is-landing"/>
    </div>
    <div class="setting-control">
        <label for="stair-show-railing">Korkuluk Göster:</label>
        <input type="checkbox" id="stair-show-railing" checked/>
    </div>
    <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px;">
         <button id="cancel-stair-popup" class="btn">İptal</button>
         <button id="confirm-stair-popup" class="btn">Tamam</button>
    </div>
</div>
<div id="guide-context-menu">
    <div class="context-menu-title">Referans Ekle</div>
    <button id="guide-btn-point" class="context-menu-btn">Nokta</button>
    <button id="guide-btn-horizontal" class="context-menu-btn">Yatay</button>
    <button id="guide-btn-vertical" class="context-menu-btn">Düşey</button>
    <button id="guide-btn-angular" class="context-menu-btn">Açısal</button>
    <button id="guide-btn-free" class="context-menu-btn">Serbest</button>
</div>
<canvas id="c2d"></canvas>
<input type="text" id="length-input" />
</div>
<div id="splitter"></div>
<div id="p3d" class="panel">
    <canvas id="c3d"></canvas>
    <!-- 3D Overlay: FPS ve Kamera Konumu (Sol Üst) -->
    <div id="stats-overlay" style="display: none;">
        <button id="bFirstPerson" class="btn">FPS Kamera</button>
        <span id="camera-coords">x: 0, y: 0, z: 0</span>
    </div>
    <!-- 3D Overlay: Ekran Bölme Oranı Butonları (Sağ Üst) -->
    <div id="split-ratio-buttons" style="display: none;">
        <button id="split-100" class="split-btn" data-ratio="100" title="Tam Ekran 3D">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <rect x="2" y="2" width="20" height="20" fill="#87CEEB" stroke="#666" stroke-width="1"/>
            </svg>
        </button>
        <button id="split-75" class="split-btn" data-ratio="75" title="75% 3D">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <rect x="2" y="2" width="5" height="20" fill="#999" stroke="#666" stroke-width="1"/>
                <rect x="7" y="2" width="15" height="20" fill="#87CEEB" stroke="#666" stroke-width="1"/>
            </svg>
        </button>
        <button id="split-50" class="split-btn" data-ratio="50" title="50% 3D / 50% 2D">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <rect x="2" y="2" width="10" height="20" fill="#999" stroke="#666" stroke-width="1"/>
                <rect x="12" y="2" width="10" height="20" fill="#87CEEB" stroke="#666" stroke-width="1"/>
            </svg>
        </button>
        <button id="split-25" class="split-btn" data-ratio="25" title="25% 3D">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <rect x="2" y="2" width="15" height="20" fill="#999" stroke="#666" stroke-width="1"/>
                <rect x="17" y="2" width="5" height="20" fill="#87CEEB" stroke="#666" stroke-width="1"/>
            </svg>
        </button>
        <button id="split-0" class="split-btn" data-ratio="0" title="3D Kapalı">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <rect x="2" y="2" width="20" height="20" fill="#999" stroke="#666" stroke-width="1"/>
            </svg>
        </button>
    </div>
</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>
    // PDF.js worker'ını ayarla
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
</script>

<script src="https://unpkg.com/@tweenjs/tween.js@23.1.1/dist/tween.umd.js"></script>
<script type="importmap">
{
"imports": {
"three": "https://unpkg.com/three@0.163.0/build/three.module.js",
"three/addons/": "https://unpkg.com/three@0.163.0/examples/jsm/"
}
}
</script>
<!-- <script src="config.js"></script> -->
<script type="module" src="general-files/main.js"></script>
<script type="module" src="wall/wall-panel.js"></script>
<script type="module" src="draw/guide-menu.js"></script> </body>
</body>
</html>